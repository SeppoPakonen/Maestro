id: "CMD-task"
layer: "cli"
title: "task command surface"
status: "partial"
confidence: "medium"
storage_backend: "unknown"

commands:
  - "maestro task"
  - "maestro task list"
  - "maestro task add"
  - "maestro task remove"

nodes:
  - id: "task-command-entry"
    type: "command"
    label: "maestro task"
  - id: "parse-subcommands"
    type: "subcommand"
    label: "Parse task subcommands"
  - id: "session-check"
    type: "validation"
    label: "Session provided check"
  - id: "load-session"
    type: "handler"
    label: "Load session"
  - id: "validate-session"
    type: "validation"
    label: "Validate session schema"
  - id: "subcommand-check"
    type: "validation"
    label: "Subcommand provided check"
  - id: "route-task-operation"
    type: "handler"
    label: "Route to handle_task_command"
  - id: "execute-task-op"
    type: "handler"
    label: "Execute task operation"
  - id: "output-results"
    type: "command"
    label: "Output results to stdout"

edges:
  - from: "task-command-entry"
    to: "parse-subcommands"
  - from: "parse-subcommands"
    to: "session-check"
  - from: "session-check"
    to: "load-session"
    condition: "Session provided"
  - from: "session-check"
    to: "hard-stop-no-session"
    condition: "No session provided"
  - from: "load-session"
    to: "validate-session"
  - from: "validate-session"
    to: "subcommand-check"
  - from: "subcommand-check"
    to: "route-task-operation"
    condition: "Valid subcommand"
  - from: "route-task-operation"
    to: "execute-task-op"
  - from: "execute-task-op"
    to: "output-results"

exports:
  - "Updates to task data in docs/"
  - "Updates session file"

evidence:
  - "maestro/commands/task.py"
  - "docs/workflows/internal/cmd_task.md"
  - "docs/workflows/internal/cmd_task.puml"

notes:
  - "Specific behavior for each subcommand (list, add, remove) not fully documented"
  - "Storage backend not explicitly mentioned in documentation"
