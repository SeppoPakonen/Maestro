id: "CMD-convert"
layer: "code"
title: "convert deep internal flow (observed)"
status: "partial"
confidence: "medium"
storage_backend: "unknown"

calls:
  - maestro.main.main
  - maestro.commands.convert.add_convert_parser
  - maestro.commands.convert.handle_convert_new
  - maestro.commands.convert.handle_convert_plan
  - maestro.commands.convert.handle_convert_run
  - maestro.commands.convert.handle_convert_status
  - maestro.commands.convert.handle_convert_show
  - maestro.commands.convert.handle_convert_reset
  - maestro.commands.convert.handle_convert_batch
  - maestro.convert.convert_orchestrator.create_new_pipeline
  - maestro.convert.convert_orchestrator.reset_pipeline
  - maestro.convert.planner.plan_conversion
  - maestro.convert.execution_engine.run_conversion_pipeline
  - maestro.ui_facade.convert.get_pipeline_status

stores:
  - .maestro/convert/

nodes:
  - id: "main_entry"
    type: "function"
    module: "maestro/main.py"
    function: "main()"
  - id: "add_convert_parser"
    type: "function"
    module: "maestro/commands/convert.py"
    function: "add_convert_parser()"
  - id: "handle_convert_new"
    type: "function"
    module: "maestro/commands/convert.py"
    function: "handle_convert_new()"
  - id: "handle_convert_plan"
    type: "function"
    module: "maestro/commands/convert.py"
    function: "handle_convert_plan()"
  - id: "handle_convert_run"
    type: "function"
    module: "maestro/commands/convert.py"
    function: "handle_convert_run()"
  - id: "handle_convert_status"
    type: "function"
    module: "maestro/commands/convert.py"
    function: "handle_convert_status()"
  - id: "handle_convert_show"
    type: "function"
    module: "maestro/commands/convert.py"
    function: "handle_convert_show()"
  - id: "handle_convert_reset"
    type: "function"
    module: "maestro/commands/convert.py"
    function: "handle_convert_reset()"
  - id: "handle_convert_batch"
    type: "function"
    module: "maestro/commands/convert.py"
    function: "handle_convert_batch()"
  - id: "create_new_pipeline"
    type: "function"
    module: "maestro/convert/convert_orchestrator.py"
    function: "create_new_pipeline()"
  - id: "reset_pipeline"
    type: "function"
    module: "maestro/convert/convert_orchestrator.py"
    function: "reset_pipeline()"
  - id: "plan_conversion"
    type: "function"
    module: "maestro/convert/planner.py"
    function: "plan_conversion()"
  - id: "run_conversion_pipeline"
    type: "function"
    module: "maestro/convert/execution_engine.py"
    function: "run_conversion_pipeline()"
  - id: "get_pipeline_status"
    type: "function"
    module: "maestro/ui_facade/convert.py"
    function: "get_pipeline_status()"
  - id: "pipeline_status_class"
    type: "class"
    module: "maestro/ui_facade/convert.py"
    class: "PipelineStatus"
  - id: "pipeline_stage_class"
    type: "class"
    module: "maestro/ui_facade/convert.py"
    class: "PipelineStage"
  - id: "maestro_convert_dir"
    type: "datastore"
    description: ".maestro/convert/ directory for pipeline definitions, state, logs"

edges:
  - from: "main_entry"
    to: "add_convert_parser"
    type: "call"
  - from: "main_entry"
    to: "handle_convert_new"
    type: "call"
  - from: "main_entry"
    to: "handle_convert_plan"
    type: "call"
  - from: "main_entry"
    to: "handle_convert_run"
    type: "call"
  - from: "main_entry"
    to: "handle_convert_status"
    type: "call"
  - from: "main_entry"
    to: "handle_convert_show"
    type: "call"
  - from: "main_entry"
    to: "handle_convert_reset"
    type: "call"
  - from: "main_entry"
    to: "handle_convert_batch"
    type: "call"
  - from: "handle_convert_new"
    to: "create_new_pipeline"
    type: "call"
  - from: "create_new_pipeline"
    to: "maestro_convert_dir"
    type: "call"
  - from: "handle_convert_plan"
    to: "plan_conversion"
    type: "call"
  - from: "plan_conversion"
    to: "maestro_convert_dir"
    type: "call"
  - from: "handle_convert_run"
    to: "run_conversion_pipeline"
    type: "call"
  - from: "run_conversion_pipeline"
    to: "maestro_convert_dir"
    type: "call"
  - from: "handle_convert_status"
    to: "get_pipeline_status"
    type: "call"
  - from: "handle_convert_show"
    to: "get_pipeline_status"
    type: "call"
  - from: "get_pipeline_status"
    to: "maestro_convert_dir"
    type: "call"
  - from: "get_pipeline_status"
    to: "pipeline_status_class"
    type: "call"
  - from: "get_pipeline_status"
    to: "pipeline_stage_class"
    type: "call"
  - from: "handle_convert_reset"
    to: "reset_pipeline"
    type: "call"
  - from: "reset_pipeline"
    to: "maestro_convert_dir"
    type: "call"

evidence:
  - type: "documentation"
    path: "v1/command_convert.md"
  - type: "diagram"
    path: "v1/command_convert.puml"

ledger_hints:
  - "Observed .maestro/convert/ directory usage in cmd_convert deep flow; violates FORBID_REPO_DOT_MAESTRO invariant; migrate to ./docs/maestro/convert/"
