id: CMD-root
layer: cli
title: root command surface
status: correct
confidence: high
storage_backend: unknown

commands:
  - maestro root get
  - maestro root set
  - maestro root refine
  - maestro root discuss
  - maestro root show

nodes:
  - id: cli_invocation
    type: command
    label: Maestro CLI Invocation
  - id: parse_args
    type: argparse
    label: Parse CLI arguments
  - id: determine_root_command
    type: validation
    label: Determine command is 'root'
  - id: session_check
    type: validation
    label: Session provided check
  - id: load_session
    type: handler
    label: Load session
  - id: hard_stop_session
    type: hard_stop
    label: Hard stop - Session required
  - id: validate_session_schema
    type: validation
    label: Validate session schema
  - id: subcommand_check
    type: decision
    label: Subcommand provided check
  - id: subcommand_set
    type: subcommand
    label: Route to handle_root_set
  - id: subcommand_get
    type: subcommand
    label: Route to handle_root_get
  - id: subcommand_refine
    type: subcommand
    label: Route to handle_root_refine
  - id: subcommand_discuss
    type: subcommand
    label: Route to handle_root_discuss
  - id: subcommand_show
    type: subcommand
    label: Route to handle_root_show
  - id: show_help
    type: command
    label: Show root help
  - id: read_docs_truth
    type: handler
    label: Read from docs truth store
  - id: execute_root_task
    type: handler
    label: Execute root task operation
  - id: write_docs_truth
    type: handler
    label: Write to docs truth store
  - id: output_results
    type: command
    label: Output results to stdout
  - id: exit_ok
    type: command
    label: Exit with success
  - id: exit_fail
    type: command
    label: Exit with failure

edges:
  - from: cli_invocation
    to: parse_args
    type: control
  - from: parse_args
    to: determine_root_command
    type: control
  - from: determine_root_command
    to: session_check
    type: control
  - from: session_check
    to: load_session
    condition: Session provided
    type: control
  - from: session_check
    to: hard_stop_session
    condition: No session provided
    type: control
  - from: load_session
    to: validate_session_schema
    type: control
  - from: validate_session_schema
    to: subcommand_check
    type: control
  - from: subcommand_check
    to: subcommand_set
    condition: Subcommand is 'set'
    type: control
  - from: subcommand_check
    to: subcommand_get
    condition: Subcommand is 'get'
    type: control
  - from: subcommand_check
    to: subcommand_refine
    condition: Subcommand is 'refine'
    type: control
  - from: subcommand_check
    to: subcommand_discuss
    condition: Subcommand is 'discuss'
    type: control
  - from: subcommand_check
    to: subcommand_show
    condition: Subcommand is 'show'
    type: control
  - from: subcommand_check
    to: show_help
    condition: No valid subcommand
    type: control
  - from: subcommand_set
    to: read_docs_truth
    type: control
  - from: subcommand_get
    to: read_docs_truth
    type: control
  - from: subcommand_refine
    to: read_docs_truth
    type: control
  - from: subcommand_discuss
    to: read_docs_truth
    type: control
  - from: subcommand_show
    to: read_docs_truth
    type: control
  - from: read_docs_truth
    to: execute_root_task
    type: control
  - from: execute_root_task
    to: write_docs_truth
    type: control
  - from: write_docs_truth
    to: output_results
    type: control
  - from: output_results
    to: exit_ok
    type: control
  - from: show_help
    to: exit_fail
    type: control

exports:
  - writes root task data to docs/
  - updates session file
  - outputs root task information to stdout
  - success/failure messages
  - error details if operations fail

evidence:
  - type: documentation
    path: docs/workflows/v1/command_surface/cmd_root.md
  - type: v1_diagram
    path: docs/workflows/v1/command_surface/cmd_root.puml

notes:
  - Storage backend is not explicitly mentioned in documentation
