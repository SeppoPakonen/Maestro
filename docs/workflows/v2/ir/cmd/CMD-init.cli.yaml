id: "CMD-init"
layer: "cli"
title: "init command surface"
status: "correct"
confidence: "high"
storage_backend: "unknown"

commands:
  - "maestro init"

nodes:
  - id: "parse_command"
    type: "argparse"
    label: "Parse command from CLI"
  - id: "identify_command"
    type: "validation"
    label: "Identify command as 'init'"
  - id: "route_to_handler"
    type: "handler"
    label: "Route to init handler"
  - id: "call_init_handler"
    type: "function"
    label: "Call handle_init_command(args)"
  - id: "initialize_structure"
    type: "function"
    label: "Initialize repository structure"
  - id: "create_docs_dir"
    type: "function"
    label: "Create docs/ directory"
  - id: "create_config_files"
    type: "function"
    label: "Create config files"
  - id: "exit_success"
    type: "command"
    label: "Exit with success code"
  - id: "exit_failure"
    type: "hard_stop"
    label: "Exit with failure code"

edges:
  - from: "parse_command"
    to: "identify_command"
  - from: "identify_command"
    to: "route_to_handler"
  - from: "route_to_handler"
    to: "call_init_handler"
  - from: "call_init_handler"
    to: "initialize_structure"
  - from: "initialize_structure"
    to: "create_docs_dir"
  - from: "create_docs_dir"
    to: "create_config_files"
  - from: "create_config_files"
    to: "exit_success"
  - from: "call_init_handler"
    to: "exit_failure"
    condition: "Initialization fails"

exports:
  - "writes repo conf"
  - "creates directory structure"
  - "creates config files"

evidence:
  - "maestro/commands/init.py"
  - "docs/workflows/internal/cmd_init.md"
