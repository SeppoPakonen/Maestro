# WF-06: AI Task Work Sessions + WSession Breadcrumb

## Short Intent
This workflow covers AI-assisted work sessions with session tracking, breadcrumbs for progress, and multi-session management.

## Preconditions
- An existing task that needs AI assistance
- AI system is available and configured
- User has appropriate permissions to start and track work sessions

## Steps Table

| Step | Command | Why | Gates |
|------|---------|-----|-------|
| 1 | `maestro work task --id "TASK-001"` | Begin working on the specified task, creating a work session with cookie/run ID | WSESSION_COOKIE_GATE |
| 2 | `maestro ai prompt --with-cookie "TASK-001_COOKIE"` | Send AI prompt that includes the work session cookie | WSESSION_COOKIE_GATE |
| 3 | `maestro wsession breadcrumb --cookie "TASK-001_COOKIE" --message "Started investigating the issue"` | Record a breadcrumb in the work session to track progress | WSESSION_COOKIE_GATE |
| 4 | `maestro wsession breadcrumb --cookie "TASK-001_COOKIE" --message "Identified the root cause"` | Record another breadcrumb in the work session | WSESSION_COOKIE_GATE |
| 5 | `maestro wsession complete --cookie "TASK-001_COOKIE"` | Mark the work session as complete | WSESSION_COOKIE_GATE |
| 6 | `maestro wsession resume --id "SESSION-001"` | Resume a previous work session if needed | WSESSION_COOKIE_GATE |

## Expected Internal Flow (Coarse)

- Work session creation assigns a unique cookie/run ID
- AI system receives prompts with session context
- Breadcrumb system tracks progress and key decisions
- Work session management maintains state across interactions
- Session completion updates task status
- Session resumption allows continuing previous work

## Data Touches

### Stores Read
- `REPO_TRUTH_DOCS_MAESTRO` - To read task details and session information
- `HOME_HUB_REPO` - For user-specific settings and session preferences

### Stores Write
- `REPO_TRUTH_DOCS_MAESTRO` - To store session cookies, breadcrumbs, and work progress
- `IPC_MAILBOX` - For communication with AI system (file-based)

## Open Questions / Unknowns

- What is the exact command for starting AI-assisted work on a task? Is it `maestro work task --id`?
- What is the exact command for AI prompting with cookies? Is it `maestro ai prompt --with-cookie`?
- What is the exact command for completing a work session? Is it `maestro wsession complete`?
- What is the correct command for resuming work sessions? Is it `maestro wsession resume`?

## Trace Block

```yaml
trace:
  - user: "maestro work task --id \"TASK-001\""
    gates: ["WSESSION_COOKIE_GATE"]
    stores_write: ["REPO_TRUTH_DOCS_MAESTRO"]
    internal: ["UNKNOWN"]
  - user: "maestro ai prompt --with-cookie \"TASK-001_COOKIE\""
    gates: ["WSESSION_COOKIE_GATE"]
    stores_read: ["REPO_TRUTH_DOCS_MAESTRO"]
    internal: ["UNKNOWN"]
  - user: "maestro wsession breadcrumb --cookie \"TASK-001_COOKIE\" --message \"Started investigating the issue\""
    gates: ["WSESSION_COOKIE_GATE"]
    stores_write: ["REPO_TRUTH_DOCS_MAESTRO"]
    internal: ["UNKNOWN"]
  - user: "maestro wsession breadcrumb --cookie \"TASK-001_COOKIE\" --message \"Identified the root cause\""
    gates: ["WSESSION_COOKIE_GATE"]
    stores_write: ["REPO_TRUTH_DOCS_MAESTRO"]
    internal: ["UNKNOWN"]
  - user: "maestro wsession complete --cookie \"TASK-001_COOKIE\""
    gates: ["WSESSION_COOKIE_GATE"]
    stores_write: ["REPO_TRUTH_DOCS_MAESTRO"]
    internal: ["UNKNOWN"]
  - user: "maestro wsession resume --id \"SESSION-001\""
    gates: ["WSESSION_COOKIE_GATE"]
    stores_read: ["REPO_TRUTH_DOCS_MAESTRO"]
    internal: ["UNKNOWN"]
```