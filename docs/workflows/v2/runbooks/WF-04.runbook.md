# WF-04: Reactive Compile Error Solution

## Short Intent
This workflow covers handling compile errors reactively by matching solutions, creating tracking issues, and managing the resolution process.

## Preconditions
- A repository with existing code that has compile errors
- Build system is configured and operational
- Solution database or AI system is available to suggest fixes

## Steps Table

| Step | Command | Why | Gates |
|------|---------|-----|-------|
| 1 | `maestro build` | Attempt to build the project, potentially triggering compile errors | READONLY_GUARD |
| 2 | `maestro solutions list` | Show available solutions for detected errors | REPOCONF_GATE |
| 3 | `maestro solutions menu` | Present an interactive menu of possible solutions | REPOCONF_GATE |
| 4 | `maestro issue create --title "Compile Error Resolution" --description "Issue created to track resolution of compile errors"` | Create an issue to track the error resolution | REPOCONF_GATE |
| 5 | `maestro task create --issue "COMPILE-ERROR-001" --title "Try solution for compile error" --description "Apply the suggested solution to fix compile errors"` | Create a task to implement the solution | REPOCONF_GATE |
| 6 | `maestro apply solution --id "SOLUTION-001"` | Apply the specified solution to fix the error | READONLY_GUARD |
| 7 | `maestro build` | Attempt to build again after applying the solution | READONLY_GUARD |
| 8 | `maestro task create --title "Manual investigation required" --description "The automated solution did not work, manual investigation needed"` | Create a new task for manual investigation if the solution fails | REPOCONF_GATE |

## Expected Internal Flow (Coarse)

- Build system integration attempts compilation and detects errors
- Error detection system identifies specific error patterns
- Solution matcher finds potential fixes from database or AI
- Issue tracker creates tracking items for error resolution
- Task management system organizes solution implementation
- Solution application system applies fixes to codebase
- Build system attempts compilation again to verify fix
- If solution fails, creates new tasks for manual investigation

## Data Touches

### Stores Read
- `REPO_TRUTH_DOCS_MAESTRO` - To read project structure and configuration
- `HOME_HUB_REPO` - For user-specific settings and solution history

### Stores Write
- `REPO_TRUTH_DOCS_MAESTRO` - To store issues, tasks, and solution application results
- `IPC_MAILBOX` - For communication with external build processes

## Open Questions / Unknowns

- What is the exact command for listing solutions? Is it `maestro solutions list`?
- Does the `maestro solutions menu` command exist or is there another way to present solutions?
- What is the correct command for creating tasks? Is it `maestro task create`?
- What is the exact command for applying solutions? Is it `maestro apply solution`?
- How does the system determine if a solution has failed and needs manual investigation?

## Trace Block

```yaml
trace:
  - user: "maestro build"
    gates: ["READONLY_GUARD"]
    stores_write: ["REPO_TRUTH_DOCS_MAESTRO"]
    internal: ["UNKNOWN"]
  - user: "maestro solutions list"
    gates: ["REPOCONF_GATE"]
    stores_read: ["REPO_TRUTH_DOCS_MAESTRO"]
    internal: ["UNKNOWN"]
  - user: "maestro solutions menu"
    gates: ["REPOCONF_GATE"]
    stores_read: ["REPO_TRUTH_DOCS_MAESTRO"]
    internal: ["UNKNOWN"]
  - user: "maestro issue create --title \"Compile Error Resolution\" --description \"Issue created to track resolution of compile errors\""
    gates: ["REPOCONF_GATE"]
    stores_write: ["REPO_TRUTH_DOCS_MAESTRO"]
    internal: ["UNKNOWN"]
  - user: "maestro task create --issue \"COMPILE-ERROR-001\" --title \"Try solution for compile error\" --description \"Apply the suggested solution to fix compile errors\""
    gates: ["REPOCONF_GATE"]
    stores_write: ["REPO_TRUTH_DOCS_MAESTRO"]
    internal: ["UNKNOWN"]
  - user: "maestro apply solution --id \"SOLUTION-001\""
    gates: ["READONLY_GUARD"]
    stores_write: ["REPO_TRUTH_DOCS_MAESTRO"]
    internal: ["UNKNOWN"]
  - user: "maestro build"
    gates: ["READONLY_GUARD"]
    stores_write: ["REPO_TRUTH_DOCS_MAESTRO"]
    internal: ["UNKNOWN"]
  - user: "maestro task create --title \"Manual investigation required\" --description \"The automated solution did not work, manual investigation needed\""
    gates: ["REPOCONF_GATE"]
    stores_write: ["REPO_TRUTH_DOCS_MAESTRO"]
    internal: ["UNKNOWN"]
```