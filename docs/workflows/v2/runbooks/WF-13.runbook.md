# WF-13: Read-only â†’ Adopt Bridge (Home Hub to Repo Truth)

## Short Intent
This workflow covers the transition from read-only scanning to repo adoption, moving from home hub storage to repo truth.

## Preconditions
- Repository is initially unadopted
- Read-only inspection is permitted
- User is willing to adopt and persist repo truth

## Steps Table

| Step | Command | Why | Gates |
|------|---------|-----|-------|
| 1 | `maestro init --readonly` | Start in read-only mode and target home hub storage | READONLY_GUARD |
| 2 | `maestro repo resolve --level lite --readonly` | Scan repo and write to home hub | REPO_RESOLVE_LITE, READONLY_GUARD |
| 3 | `maestro make build --dry-run` | Optional diagnostic build without repo writes | READONLY_GUARD |
| 4 | `maestro init` | Adopt repo and create `./docs/maestro/` | REPOCONF_GATE |
| 5 | `maestro repo resolve --level lite` | Re-run resolve into repo truth | REPO_RESOLVE_LITE |
| 6 | `maestro repo conf show` | Ensure RepoConf is present after adoption | REPOCONF_GATE |
| 7 | `maestro make build` | Proceed with build using repo truth | REPOCONF_GATE |

## Expected Internal Flow (Coarse)

- Read-only guard routes output to home hub
- Adoption creates repo truth structure
- Resolve re-runs into repo truth
- RepoConf gate ensures build readiness

## Data Touches

### Stores Read
- `REPO_TRUTH_DOCS_MAESTRO` - After adoption, read repo truth state
- `HOME_HUB_REPO` - Read-only cache and initial scan outputs

### Stores Write
- `HOME_HUB_REPO` - Read-only scan outputs
- `REPO_TRUTH_DOCS_MAESTRO` - Adopted repo truth data

## Open Questions / Unknowns

- Does `maestro init --readonly` exist or is read-only configured differently?
- Is `maestro make build` the correct build command for this workflow?
- Is `maestro repo conf show` the correct way to verify RepoConf after adoption?
- Is there a supported import path from home hub to repo truth?

## Trace Block

```yaml
trace:
  - user: "maestro init --readonly"
    gates: ["READONLY_GUARD"]
    stores_write: ["HOME_HUB_REPO"]
    internal: ["UNKNOWN"]
  - user: "maestro repo resolve --level lite --readonly"
    gates: ["REPO_RESOLVE_LITE", "READONLY_GUARD"]
    stores_write: ["HOME_HUB_REPO"]
    internal: ["UNKNOWN"]
  - user: "maestro make build --dry-run"
    gates: ["READONLY_GUARD"]
    stores_read: ["HOME_HUB_REPO"]
    internal: ["UNKNOWN"]
  - user: "maestro init"
    gates: ["REPOCONF_GATE"]
    stores_write: ["REPO_TRUTH_DOCS_MAESTRO"]
    internal: ["UNKNOWN"]
  - user: "maestro repo resolve --level lite"
    gates: ["REPO_RESOLVE_LITE"]
    stores_write: ["REPO_TRUTH_DOCS_MAESTRO"]
    internal: ["UNKNOWN"]
  - user: "maestro repo conf show"
    gates: ["REPOCONF_GATE"]
    stores_read: ["REPO_TRUTH_DOCS_MAESTRO"]
    internal: ["UNKNOWN"]
  - user: "maestro make build"
    gates: ["REPOCONF_GATE"]
    stores_write: ["REPO_TRUTH_DOCS_MAESTRO"]
    internal: ["UNKNOWN"]
```
